id: slide_image
title: Diagnostic slide image
type: object
description: Diagnostic slide image
additionalProperties: false
category: data_bundle
validators: null

systemProperties:
    id:
        $ref: "_definitions#/UUID"
    project_id:
        $ref: "_definitions#/UUID"
    state:
        $ref: "_definitions#/data_bundle_state"

links:
    - name: portion
      label: describes
      target_type: portion
      multiplicity: one_to_one
      required: true

required: [ type, portion, image_files ]

uniqueKeys:
    - [id]

properties:
    type:
        enum: [ "slide_image" ]
    portion:
        $ref: "_definitions#/to_one"

    image_files:
        type: array
        minItems: 1
        items:
            id: slide_image/image_file
            title: Diagnostic slide image file
            type: object
            description: Diagnostic slide image
            additionalProperties: false
            category: data_file
            validators: null

            systemProperties:
                id:
                    $ref: "_definitions#/UUID"
                project_id:
                    $ref: "_definitions#/UUID"
                state:
                    $ref: "_definitions#/data_file_state"

            links:
                - name: slide_image_bundle
                  label: part_of
                  target_type: slide_image
                  multiplicity: many_to_one
                  required: true

            required: [ type, file_name, file_format, file_size, md5sum ]

            uniqueKeys:
                - [ id ]
                - [ project_id, file_name ]
                - [ project_id, submitter_id ]

            properties:
                type:
                    enum: [ slide_image/image_file ]
                submitter_id:
                    type:
                      - string
                      - "null"
                note:
                    type: string
                file_name:
                    $ref: "_definitions#/file_name"
                file_format:
                    $ref: "_definitions#/file_format"
                    enum: [ "svs", "dicom" ]
                file_size:
                    $ref: "_definitions#/file_size"
                md5sum:
                    $ref: "_definitions#/md5sum"
                slide_image_bundle:
                    $ref: "_definitions#/to_one"

