$schema: "http://json-schema.org/draft-04/schema#"

#id: "term"
id: "http://localhost:8080/term.yaml"
title: Term semantic information
type: object
namespace: http://gdc.nci.nih.gov
category: TBD
program: '*'
project: '*'
description: >
  An object that contains information regarding the semantics of any schema
  item name. It can serve as the value for the description key in any schema.
additionalProperties: false
validators: []

systemProperties:
  - id

links:
  - name: synonyms
    label: is_synonym
    backref: synonyms
    multiplicity: many_to_many
    target_type: term
    required: false

uniqueKeys:
  - [id]
  
required:
  - type
  - id
  - term
  - termdef
  
properties:
  type:
    type: string
    enum:
      - term
  id:
#    $ref: "definitions.yaml#/UUID"
    $ref: "http://localhost:8080/definitions.yaml#/UUID"
  term:
    type: string
    description: >
      This is the token as used in the schema or other code that uses the
      term. Put the full text of the term in termdef:term, below.
  termns:
    oneOf:
      - type: string
        pattern: "^([a-zA-Z_]+\\/?)*$"
      - type: "null"
    description: >
      Optional namespace string of the form <token1[/token2/...]>.
      Convention: <token1> from ["administrative","biospecimen","clinical",
      "molecular","relationship"]. <token2>, name of GDC dictionary in which
      the term is used as a property (if any).
      is used
  termdef:
    $ref: "#/definitions/termdef"
  synonyms:
#    $ref: "definitions.yaml#/to_many"
    $ref: "http://localhost:8080/definitions.yaml#/to_many"

definitions:
  termdef:
    type: object
    required:
      - term_id
      - term
      - definition
    properties:
      term_id:
#        $ref: "definitions.yaml#/UUID"
        $ref: "http://localhost:8080/definitions.yaml#/UUID"
      term:
        type: string
      definition:
        type: string
        description: >
          Definition of term, ideally obtained verbatim from one of the
          authorities identified in source property (below)
      locale:
        oneOf:
          - type: string
            pattern: "^[A-z][A-z]$"
          - type: "null"
        description: >
          ISO 639-1 two-letter language code (language of term and definition)
      values:
        oneOf:
          - $ref: "http://json-schema.org/draft-04/schema#"
          - type: "null"
        description: >
            If the term itself is used as a key elsewhere, the values field
            contains a valid jsonschema that defines the acceptable values
            for the key.
      source:
        type: object
        properties:
          uri:
            oneOf:
              - type: string
                format: uri
              - type: "null"
            description: >
              Optional ontology URI for this term (need not resolve);
              can be null
          cde:
            type: object
            properties:
              collection_name:
                oneOf:
                  - type: string
                  - type: "null"
                description: >
                  Common name for collection if any (e.g. caDSR, NCIt)
              collection_url:
                oneOf:
                  - type: string
                  - type: "null"
                format: uri
                description: Resolving URL to CDE collection (e.g., caDSR, NCIt)
              cde_id:
                oneOf:
                  - type: string
                  - type: number
                  - type: "null"
                description: >
                  CDE public id for the term, should be queryable at
                  collection URL. Put version number in cde_version
                  property.
              cde_version:
                oneOf:
                  - type: string
                  - type: number
                  - type: "null"
