#####################################################################
# Reusable reference definitions
#####################################################################

$schema: "http://json-schema.org/draft-04/schema#"

UUID:
    type: string
    pattern: "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"

parent_uuids:
    type: array
    minItems: 1
    items:
      $ref: "#/UUID"
    uniqueItems: true

foreign_key:
  type: object
  additionalProperties: false
  #Can either use 'id' which are GDC IDs (UUID) or 'submitter_id'
  #which are user defined IDs ("submitter IDs in the backend")
  anyOf:
    - required:
        - id
    - required:
        - submitter_id

  properties:
    id:
      $ref: "#/UUID"
    submitter_id:
      type: string

to_one:
  anyOf:
    - type: array
      items:
        $ref: "#/foreign_key"
      minItems: 1
    - $ref: "#/foreign_key"

to_many:
  anyOf:
    - type: array
      items:
        $ref: "#/foreign_key"
      minItems: 1
    - $ref: "#/foreign_key"
