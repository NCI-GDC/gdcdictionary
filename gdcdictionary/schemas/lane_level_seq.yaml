$schema: "http://json-schema.org/draft-04/schema#"

id: lane_level_seq
title: Lane Level Seq
type: object
description: Sequencing reads from one lane of an NGS run
additionalProperties: false
category: data_bundle
validators: null
project: '*'
program: '*'

systemProperties:
  - id
  - project_id
  - created_datetime
  - updated_datetime
  - state
  - release_state
  - release_state_datetime
  - release_state_lock

links:
    - name: aliquots
      label: derived_from
      target_type: aliquot
      multiplicity: many_to_one
      required: true
      backref: lane_level_seqs

required:
    - type
    - aliquots
    - sequencing_center
    - platform
    - library_strategy
    - library_name
    - is_paired_end
    - read_length
    - read_group_id

uniqueKeys:
    - [ id ]
    - [ project_id, read_group_id ]

properties:
    id:
        $ref: "_definitions.yaml#/UUID"
    project_id:
        type: string
    state:
        $ref: "_definitions.yaml#/data_bundle_state"
    type:
        enum: [ "lane_level_seq" ]
    sequencing_center:
        type: string
    platform:
        enum:
            - ILLUMINA
            - SOLID
            - LS454
            - Ion Torrent
            - PACBIO
    library_strategy:
        enum:
            - WGS
            - WXS
            - RNA-Seq
            - ChIP-Seq
    library_name:
        type: string
    insert_size:
        type: integer
    target_capture_kit_name:  # conditionally required for WXS etc
        type: string
    target_capture_kit_target_region:  #
        type: string
    is_paired_end:
        type: boolean
    read_length:
        type: integer
    read_group_id:  # it may be good to assign UUID to read group
        type: string
    bqsr_performed:
        type: boolean
    aliquots:
        $ref: "_definitions.yaml#/to_one"
    created_datetime:
        $ref: "_definitions.yaml#/datetime"
    updated_datetime:
        $ref: "_definitions.yaml#/datetime"

    # ======== Release state ========
    release_state:
        $ref: "_definitions.yaml#/release_state"
    release_state_datetime:
        $ref: "_definitions.yaml#/datetime"
    release_state_lock:
        $ref: "_definitions.yaml#/release_state_lock"
